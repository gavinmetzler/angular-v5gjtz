<h1>Tile Cutting Order Form</h1>
<form [formGroup]="myForm" [hidden]="success" (ngSubmit)="submitHandler()">
  <hr>
  <h2>Contact information</h2>
  <mat-form-field class="dp">
    <input matInput placeholder="Name" formControlName="name">
        <mat-error *ngIf="myForm['controls']?.name.invalid && name.touched" class="has-text-danger">
            *required
        </mat-error>
  </mat-form-field>    
 
  <mat-form-field class="dp">
    <input matInput placeholder="Email" formControlName="email">
      <mat-error *ngIf="email.invalid && email.touched" class="has-text-danger">
            *please enter a valid email address
      </mat-error>
  </mat-form-field>  
  
  <mat-form-field class="dp">
    <input matInput placeholder="Company" formControlName="company">
  </mat-form-field>  
  <br>
  <mat-form-field class="dp">
      <input matInput [matDatepicker]="reqDate" placeholder="Date required" (dateInput)="thongyChanged('input', $event)">
      <mat-datepicker-toggle matSuffix [for]="reqDate"></mat-datepicker-toggle>
      <mat-datepicker #reqDate></mat-datepicker>
  </mat-form-field>  
  <mat-form-field class="dp">
    <input matInput placeholder="Order Number" formControlName="orderNum">
  </mat-form-field>  
  <br>
  
      <div formArrayName="tiles">

        <div *ngFor="let tile of myForm['controls'].tiles['controls']; let i=index" [formGroupName]="i">
          <hr>
        <h2>Tile to cut</h2>
            <mat-form-field class="xs">
                <input matInput placeholder="Quantity" formControlName="quantity">
            </mat-form-field>
            <mat-form-field class="dp" >
                    <mat-select placeholder="Material" [(value)]="selected" formControlName="material">
                    <mat-option value="porcelain">Porcelain</mat-option>
                    <mat-option value="marble">Marble</mat-option>
                    <mat-option value="stone">Granite</mat-option>
                  </mat-select>
            </mat-form-field>
            <button mat-raised-button type="button" color="warn" (click)="deleteTile(i)">Remove Tile</button>
            <br>
            <mat-form-field class="xs">
                <input matInput placeholder="Length (mm)" formControlName="length">
            </mat-form-field>
            
            <mat-form-field class="xs">
                <input matInput placeholder="Width (mm)" formControlName="width">
            </mat-form-field>
            
            <mat-form-field class="xs">
                <input matInput placeholder="Thickness (mm)" formControlName="thickness">
            </mat-form-field>

           
            <div formArrayName="cuts">
               <h2>Cuts required</h2>
              <div *ngFor="let cut of tile['controls'].cuts['controls']; let j=index" [formGroupName]="j">
                <mat-form-field class="dp">
                   <mat-select placeholder="Cut Type" formControlName="cutType" (selectionChange)="thingyChanged('inshput', material)">
                    <mat-option value="c2s">Cut to size</mat-option>
                    <mat-option value="profile">Profile cut</mat-option>
                    <mat-option value="buildup">Build up and profile</mat-option>
                    <mat-option value="groove">Grooves</mat-option>
                  </mat-select>
                </mat-form-field>
                <button mat-raised-button type="button" color="warn" (click)="deleteCut(i)">Remove Cut</button>
              </div>
            <button mat-raised-button type="button" color="primary" (click)="addCut(i)">Add Cut</button>
            </div>
                        <div [ngSwitch]="tile['controls'].material.value">
              <span>
              <svg width="10rem" height="10em" >
                <rect width="100%" height="100%" fill="none" stroke="black" stroke-width="4" />
                <circle cx="100%" cy="100%" r="150" fill="blue" stroke="black" />
                <polygon points="120,0 240,225 0,225" fill="green"/>
                <text *ngSwitchCase="'porcelain'" x="50" y="100" font-family="Verdana" font-size="45" fill="#445544" stroke="black" stroke-width="2">porcelain!</text>
                <text *ngSwitchCase="'marble'" x="50" y="100" font-family="Verdana" font-size="45" fill="#445544" stroke="black" stroke-width="2">marble!</text>
                <text *ngSwitchCase="'stone'" x="50" y="100" font-family="Verdana" font-size="45" fill="#445544" stroke="black" stroke-width="2">stone!</text>
              </svg>
              </span>
            </div>
            <br><br><br>
        </div>

    </div>

    <button mat-raised-button type="button" color="primary" (click)="addTile()">Add Tile</button>
  <hr>
  <button mat-raised-button color="primary" type="submit" [disabled]="myForm.invalid">Submit Form</button>

</form>

<br>
<div *ngIf="success" class="notification is-success">
    Thank You! We received your submission.
</div>

<br><hr><br><br>
x{{ events }}x
  Value: {{ myForm.value | json }}
  <br>
